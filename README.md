## 1. Vafast Benchmarks

Vafast 框架性能基准测试项目，对比主流 Node.js Web 框架与 Vafast 原生框架的性能表现。

## 2. 📋 项目概述

本项目旨在通过严格的性能测试，验证 Vafast 框架在不同场景下的性能表现，并与主流框架进行对比分析。

### 🎯 测试目标

1. **简单响应性能测试**: 对比基础路由响应性能
2. **验证器性能测试**: 对比包含数据验证的复杂场景性能
3. **内存使用分析**: 监控测试过程中的内存占用情况
4. **单线程性能验证**: 确保框架在单线程环境下的优化效果

## 3. 🚀 快速开始

### 最低环境要求

1. Node.js 18+ 或 Bun 1.0+
2. 支持 ES Modules

### 安装依赖

```bash
# 1. 使用 npm
npm install

# 2. 使用 yarn
yarn install

# 3. 使用 bun
bun install
```

## 4. 📊 性能测试

### 简单响应性能测试

运行简单响应性能测试：

```bash
bun run src/simple-response-benchmark.ts
```

**测试结果 (100,000 次迭代)**
*测试时间: 2025-08-20 17:55:12 (北京时间)*

| 框架 | 版本 | 请求/秒 | 平均耗时 | 总耗时 | 排名 | 相对性能 |
|------|------|----------|----------|--------|------|----------|
| vafast原生 (工厂路由) | 0.1.2 | 676.79K (100%) | 1.48μs | 147.76ms | 🥇 第一 | 1.00x |
| vafast原生 (直接路由) | 0.1.2 | 522.02K (77.1%) | 1.92μs | 191.56ms | 🥈 第二 | 0.77x |
| Koa | 3.0.1 | 430.81K (63.7%) | 2.32μs | 232.12ms | 🥉 第三 | 0.64x |
| 原生 Response | - | 338.29K (50.0%) | 2.96μs | 295.61ms | 4 | 0.50x |
| Elysia | 1.3.13 | 291.06K (43.0%) | 3.44μs | 343.57ms | 5 | 0.43x |
| Express | 5.1.0 | 241.47K (35.7%) | 4.14μs | 414.14ms | 6 | 0.36x |
| Hono | 4.9.2 | 254.57K (37.6%) | 3.93μs | 392.81ms | 7 | 0.38x |

### 验证器性能测试

运行验证器性能测试：

```bash
bun run src/validator-benchmark.ts
```

**测试结果 (100,000 次迭代，包含 TypeBox 验证器)**
*测试时间: 2025-08-20 17:55:22 (北京时间)*

| 框架 | 版本 | 请求/秒 | 平均耗时 | 总耗时 | 排名 | 相对性能 |
|------|------|----------|----------|--------|------|----------|
| vafast原生 (TypeBox验证器) | 0.1.2 | 263.82K (100%) | 3.79μs | 379.05ms | 🥇 第一 | 1.00x |
| Express (TypeBox验证器) | 5.1.0 | 255.42K (96.8%) | 3.92μs | 391.52ms | 🥈 第二 | 0.97x |
| Elysia (TypeBox验证器) | 1.3.13 | 253.40K (96.1%) | 3.95μs | 394.63ms | 🥉 第三 | 0.96x |
| Hono (TypeBox验证器) | 4.9.2 | 114.82K (43.5%) | 8.71μs | 870.91ms | 4 | 0.44x |
| Koa (TypeBox验证器) | 3.0.1 | 33.77K (12.8%) | 29.61μs | 2.96s | 5 | 0.13x |

## 5. 🏆 性能分析

### 简单响应场景

1. **原生 Response** 表现最佳，作为基准参考
2. **Vafast 直接路由** 性能接近原生，仅损失 4.3%
3. **Vafast 工厂路由** 在功能与性能间取得平衡
4. 传统框架在简单场景下性能相对较低

### 验证器场景

1. **Vafast 原生验证器** 性能领先，验证开销最小
2. **Elysia** 验证器性能接近 Vafast，表现优秀
3. **Hono** 验证器性能中等，适合中等复杂度项目
4. **Express/Koa** 验证器性能较低，适合简单项目

## 6. 💡 使用建议

### 性能优先场景

1. **极简路由**: 使用 Vafast 直接路由获得最佳性能
2. **简单验证**: 使用 Vafast 原生验证器平衡性能和功能

### 功能优先场景

1. **复杂业务**: 使用完整验证获得全部功能
2. **团队开发**: 选择熟悉的传统框架降低学习成本

## 7. 🔧 项目结构

```
vafast-benchmarks/
├── src/
│   ├── config/                 # 测试配置文件
│   │   ├── simple-response-config.ts
│   │   └── validator-config.ts
│   ├── simple-response-benchmark.ts    # 简单响应测试
│   ├── validator-benchmark.ts          # 验证器测试
│   └── utils/                          # 工具函数
│       ├── benchmark-utils.ts
│       └── report-utils.ts
├── package.json
└── README.md
```

## 8. 📈 测试环境

1. **运行时**: Node.js 22.16.0
2. **平台**: macOS (darwin arm64)
3. **测试配置**: 100,000 次请求，5,000 次预热
4. **内存监控**: 实时监控测试前后内存使用情况
5. **测试时间**: 2025-08-20 17:55:22 (北京时间)

## 9. 📦 依赖版本

### 核心框架
1. **vafast**: 0.1.2
2. **elysia**: 1.3.13
3. **hono**: 4.9.2
4. **express**: 5.1.0
5. **koa**: 3.0.1

### 验证器
1. **@sinclair/typebox**: 0.32.0
2. **@hono/typebox-validator**: 0.2.0
3. **koa-bodyparser**: 4.4.1



## 10. 🤝 贡献

欢迎提交 Issue 和 Pull Request 来改进测试用例和性能分析。

## 11. 📄 许可证

本项目采用 MIT 许可证。